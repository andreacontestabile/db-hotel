GROUP BY
________________________

Conta gli ospiti raggruppandoli per anno di nascita.

SELECT COUNT('id') AS 'numero_ospiti', YEAR(`date_of_birth`) AS 'anno_di_nascita'
FROM `ospiti`
GROUP BY YEAR(`date_of_birth`);


Somma i prezzi dei pagamenti raggruppandoli per status.

SELECT SUM(price) AS 'somma_pagamenti', `status`
FROM `pagamenti`
GROUP BY `status`;


Conta quante volte è stata prenotata ogni stanza.

SELECT `stanza_id`, COUNT('id') AS 'numero_prenotazioni'
FROM `prenotazioni`
GROUP BY `stanza_id`


Fai una analisi per vedere se ci sono ore in cui le prenotazioni sono più frequenti

SELECT HOUR(`created_at`) AS 'ora_prenotazione', COUNT('id') AS 'numero_prenotazioni'
FROM `prenotazioni`
GROUP BY HOUR(`created_at`)

(intorno alle ore 03:00 le prenotazioni sono più frequenti)


Quante prenotazioni ha fatto l’ospite che ha fatto più prenotazioni?

SELECT `ospite_id`, COUNT('id') AS 'numero_prenotazioni'
FROM `prenotazioni_has_ospiti`
GROUP BY `ospite_id`

(Gli ospiti che hanno fatto più prenotazioni hanno effettuato 3 prenotazioni)



JOIN
________________________

Come si chiamano gli ospiti che hanno fatto più di due prenotazioni?

SELECT `ospite_id`, `name`, `lastname`, COUNT('id') AS 'numero_prenotazioni_ospite'
FROM `ospiti`
JOIN `prenotazioni_has_ospiti`
ON ospiti.id = prenotazioni_has_ospiti.ospite_id
GROUP BY `ospite_id`
HAVING COUNT('id') > 2


Stampare tutti gli ospiti per ogni prenotazione

SELECT `prenotazione_id`, `ospite_id`, `name`, `lastname`
FROM `prenotazioni_has_ospiti`
JOIN `ospiti`
ON ospiti.id = prenotazioni_has_ospiti.ospite_id
